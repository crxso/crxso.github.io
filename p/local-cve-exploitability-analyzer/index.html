<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="Automated CVE exploitability assessment across multiple sites"><title>Local CVE Exploitability Analyzer</title><link rel=canonical href=https://crxso.github.io/p/local-cve-exploitability-analyzer/><link rel=stylesheet href=/scss/style.min.389ec2e2031e61386474ebd4c8e5f080c8180a38baa6ee2ee16a610692d8d5e3.css><meta property='og:title' content="Local CVE Exploitability Analyzer"><meta property='og:description' content="Automated CVE exploitability assessment across multiple sites"><meta property='og:url' content='https://crxso.github.io/p/local-cve-exploitability-analyzer/'><meta property='og:site_name' content='@crxso'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='Project'><meta property='article:published_time' content='2025-10-09T14:56:21-07:00'><meta property='article:modified_time' content='2025-10-09T00:00:00+00:00'><meta property='og:image' content='https://crxso.github.io/p/local-cve-exploitability-analyzer/rivendell.jpg'><meta name=twitter:title content="Local CVE Exploitability Analyzer"><meta name=twitter:description content="Automated CVE exploitability assessment across multiple sites"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content='https://crxso.github.io/p/local-cve-exploitability-analyzer/rivendell.jpg'><link rel="shortcut icon" href=/favicon.png><style>.fixed-datetime-header{position:fixed!important;top:0!important;z-index:1000!important;background-color:var(--header-background)!important;border-bottom:1px solid var(--header-border-color)!important;color:var(--header-text-color)!important;border-radius:0 0 4px 4px;height:33px;box-sizing:border-box;left:0!important;right:0!important;width:100%!important;padding:10px 15px!important;display:flex!important;align-items:center!important;justify-content:center!important}.article-page #main{padding-top:55px!important;margin-top:0!important}body:not(.article-page) #main{padding-top:0!important;margin-top:0!important}body:not(.article-page) .custom-homepage-content{margin-top:-80px!important;padding-top:125px!important;padding-bottom:0!important;margin-bottom:0!important}@media(min-width:1025px){.fixed-datetime-header{width:auto!important;left:50%!important;transform:translateX(-50%);right:auto!important;border-radius:0 0 4px 4px;border-bottom:1px solid var(--header-border-color)!important;box-shadow:0 4px 6px rgba(0,0,0,.1);padding:8px 25px!important}}@media(min-width:900px) and (max-width:1024px){.fixed-datetime-header{width:auto!important;left:50%!important;transform:translateX(-50%);right:auto!important;border-radius:0 0 4px 4px;border-bottom:1px solid var(--header-border-color)!important;box-shadow:0 4px 6px rgba(0,0,0,.1);padding:8px 25px!important}#main{padding-top:55px!important;margin-top:0!important}}@media(max-width:899px){.fixed-datetime-header{left:0!important;right:0!important;width:100%!important;border-bottom:1px solid var(--header-border-color)!important;box-shadow:none;padding:10px 15px!important}}</style><div class=fixed-datetime-header><div id=live-time-display-container style=display:flex;justify-content:center;align-items:center;font-size:1.1em;width:auto><div id=live-time-date-wrapper style=display:flex;align-items:center;margin-right:40px><svg style="width:1.2em;height:1.2em;fill:currentColor;margin-right:5px" viewBox="0 0 24 24"><path d="M19 4h-1V2h-2v2H8V2H6v2H5c-1.11.0-1.99.9-1.99 2L3 20c0 1.1.89 2 2 2h14c1.1.0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 16H5V9h14v11zM5 7V6h14v1H5z"/></svg>
<time id=live-time-date></time></div><div id=live-time-time-wrapper style=display:flex;align-items:center><svg style="width:1.2em;height:1.2em;fill:currentColor;margin-right:5px" viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm.5 16H11V7h1.5v4.75l3.43 3.05-.94 1.48L12.5 13.5V18z"/></svg>
<time id=live-time-time></time></div></div></div><script>function updateLiveTime(){const e=document.querySelector(".fixed-datetime-header");if(!e)return;const n=e.querySelector("#live-time-date"),s=e.querySelector("#live-time-time");if(!n||!s)return;const o=new Date,i={weekday:"short",month:"short",day:"numeric",year:"numeric"},a=o.toLocaleDateString("en-US",i).replace(/,/g,""),r={hour:"numeric",minute:"2-digit",second:"2-digit",hour12:!0,timeZoneName:"short"},t=o.toLocaleTimeString("en-US",r).split(" "),c=t.slice(0,2).join(" "),l=t.length>2?t.pop():"";n.textContent=a,s.textContent=`${c} ${l}`}updateLiveTime(),setInterval(updateLiveTime,1e3)</script></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/desk_hu_e63a407afe0a777a.png width=300 height=319 class=site-logo loading=lazy alt=Avatar></a></figure><div class=site-meta><h1 class=site-name><a href=/>@crxso</a></h1><h2 class=site-description></h2></div></header><ol class=menu-social><li><a href=https://github.com/crxso target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/about/><svg class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg>
<span>About</span></a></li><li><a href=/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li><a href=/links/><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>Links</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Dark Mode</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#project-goal>Project Goal</a></li><li><a href=#methodology--technical-approach>Methodology & Technical Approach</a><ol><li><a href=#agent-roles--responsibilities-implemented-in-run_systempy>Agent Roles & Responsibilities (Implemented in <code>run_system.py</code>)</a></li></ol></li><li><a href=#core-program-descriptions>Core Program Descriptions</a><ol><li><a href=#run_systempy-the-rag-engine><code>run_system.py</code>: The RAG Engine</a></li><li><a href=#apppy-the-streamlit-frontend><code>app.py</code>: The Streamlit Frontend</a></li></ol></li><li><a href=#program-interaction-flow>Program Interaction Flow</a></li><li><a href=#results--outputs>Results & Outputs</a><ol><li><a href=#template-terminalstreamlit-log-output>Template Terminal/Streamlit Log Output</a></li><li><a href=#real-terminalstreamlit-log-output>Real Terminal/Streamlit Log Output</a></li></ol></li></ol></nav></div></section></aside><main class="main full-width"><article class="has-image main-article"><header class=article-header><div class=article-image><a href=/p/local-cve-exploitability-analyzer/><img src=/p/local-cve-exploitability-analyzer/rivendell_hu_d3bb13c168fe084c.jpg srcset="/p/local-cve-exploitability-analyzer/rivendell_hu_d3bb13c168fe084c.jpg 800w, /p/local-cve-exploitability-analyzer/rivendell_hu_8416670e94a5b777.jpg 1600w" width=800 height=500 loading=lazy alt="Featured image of post Local CVE Exploitability Analyzer"></a></div><div class=article-details><header class=article-category><a href=/categories/ai/ style=background-color:#e02424;color:#fff>AI
</a><a href=/categories/rag/ style=background-color:#0177b8;color:#fff>RAG</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/local-cve-exploitability-analyzer/>Local CVE Exploitability Analyzer</a></h2><h3 class=article-subtitle>Automated CVE exploitability assessment across multiple sites</h3></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Thu Oct 9, 2025</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>15 minute read</time></div></footer></div></header><section class=article-content><div class=table-wrapper><table><thead><tr><th style=text-align:left>Version</th><th style=text-align:left>Updated on</th><th style=text-align:left>Updated by</th></tr></thead><tbody><tr><td style=text-align:left>v1.0.0</td><td style=text-align:left>10/09/2025</td><td style=text-align:left>@crxso</td></tr></tbody></table></div><h2 id=project-goal>Project Goal</h2><p>The <strong>Local CVE Exploitability Analyzer</strong> project implements an automated system for assessing the exploitability of Common Vulnerabilities and Exposures (CVEs).</p><p>The core functionality is built upon a <strong>Retrieval-Augmented Generation (RAG)</strong> architecture using two local components:</p><ul><li>Ollama for the Language Model (LLM) and embeddings</li><li>ChromaDB for the vector store; emulating the multi-LLM agentic framework described in the project plan.</li></ul><p>The objective is to develop an automated system for assessing the exploitability of Common Vulnerabilities and Exposures (CVEs). The system uses a multi-LLM agentic framework to perform comprehensive analysis and provide a clear, actionable &ldquo;proof of exploitability&rdquo; score or narrative. The ultimate goal is to move beyond simple vulnerability detection to a proactive, threat-informed security posture.</p><hr><h2 id=methodology--technical-approach>Methodology & Technical Approach</h2><p>The system leverages an agentic AI framework where multiple specialized LLMs (agents) work together under a central orchestration layer. This approach deconstructs the CVE analysis into specialized functions, minimizing the risk of hallucination and allowing for targeted fine-tuning and debugging.</p><h3 id=agent-roles--responsibilities-implemented-in-run_systempy>Agent Roles & Responsibilities (Implemented in <code>run_system.py</code>)</h3><p>The three conceptual agents are functionally implemented within the logic of <code>run_system.py</code> and the RAG chain&rsquo;s prompt structure:</p><ul><li><p><strong>Data Retrieval Agent:</strong> Implemented by the <strong><code>fetch_and_save_cve</code></strong> function in <code>run_system.py</code>. It is responsible for retrieving all relevant CVE information from external sources like <strong>NVD</strong> and <strong>MITRE</strong> and gathering exploitation evidence from <strong>CISA KEV</strong> and <strong>Exploit-DB</strong>. The fetched data is saved locally and forms the <strong>LocalGPT RAG knowledge base</strong>.</p></li><li><p><strong>Vulnerability Analysis Agent:</strong> The first stage of the <strong><code>run_rag_chain</code></strong> in <code>run_system.py</code>, where the LLM&rsquo;s <strong>Chain of Thought (Steps 1-3)</strong> analyzes the data retrieved from the vector store to interpret the vulnerability&rsquo;s nature, root cause, and potential impact.</p></li><li><p><strong>Exploit Assessment Agent:</strong> The second stage of the <strong><code>run_rag_chain</code></strong> in <code>run_system.py</code>, where the LLM&rsquo;s <strong>Chain of Thought (Steps 4-7)</strong> synthesizes the analysis, evaluates exploitability based on PoC code, and determines the final <strong>Verdict</strong> and <strong>Mitigations & Fixes</strong>.</p></li></ul><hr><h2 id=core-program-descriptions>Core Program Descriptions</h2><p>The system consists of two main programs: the backend analysis engine (<code>run_system.py</code>) and the frontend web application (<code>app.py</code>).</p><h3 id=run_systempy-the-rag-engine><code>run_system.py</code>: The RAG Engine</h3><p>This Python script is the <strong>backend analysis engine</strong> and RAG implementation. It handles all data ingestion, vector store management, and the final LLM-based analysis.</p><div class=table-wrapper><table><thead><tr><th style=text-align:left>Function</th><th style=text-align:left>Description</th><th style=text-align:left>Conceptual Agent Role</th></tr></thead><tbody><tr><td style=text-align:left><span style=white-space:nowrap><strong><code>clear_data_directory</code></strong></span></td><td style=text-align:left>Clears the previous run&rsquo;s fetched data (<code>cve_data</code>) and the vector database (<code>cve_database</code>) to ensure a fresh, specific analysis.</td><td style=text-align:left>Orchestration Layer</td></tr><tr><td style=text-align:left><span style=white-space:nowrap><strong><code>fetch_exploit_db_id</code></strong></span></td><td style=text-align:left>Searches the Exploit-DB website to find associated exploit IDs for the target CVE.</td><td style=text-align:left>Data Retrieval Agent</td></tr><tr><td style=text-align:left><span style=white-space:nowrap><strong><code>fetch_exploit_db_poc</code></strong></span></td><td style=text-align:left>Fetches the raw Proof-of-Concept (PoC) code from Exploit-DB using the retrieved ID.</td><td style=text-align:left>Data Retrieval Agent</td></tr><tr><td style=text-align:left><span style=white-space:nowrap><strong><code>fetch_and_save_cve</code></strong></span></td><td style=text-align:left>Fetches vulnerability data from <strong>NVD</strong>, <strong>MITRE</strong>, and <strong>CISA KEV</strong>. It compiles this data, along with any Exploit-DB PoCs, into Markdown files and saves them to the <code>cve_data</code> directory.</td><td style=text-align:left>Data Retrieval Agent</td></tr><tr><td style=text-align:left><span style=white-space:nowrap><strong><code>build_vector_store</code></strong></span></td><td style=text-align:left>Initializes the <strong>ChromaDB</strong> client, loads the Markdown files from <code>cve_data</code>, chunks them using <strong><code>RecursiveCharacterTextSplitter</code></strong>, and embeds the chunks using <strong><code>OllamaEmbeddings</code></strong> (<code>nomic-embed-text</code>) to create the RAG knowledge base.</td><td style=text-align:left>Orchestration Layer / RAG Setup</td></tr><tr><td style=text-align:left><span style=white-space:nowrap><strong><code>run_rag_chain</code></strong></span></td><td style=text-align:left>This is the core analysis function. It sets up the RAG pipeline using <strong>LangChain</strong>: it retrieves relevant document chunks from the vector store and passes them, along with the Exploit-DB PoCs, to the <strong>Ollama LLM</strong> (<code>mistral:instruct</code>) with a detailed, structured prompt for generating the final analysis report.</td><td style=text-align:left>Analysis Agent & Exploit Assessment Agent</td></tr></tbody></table></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span><span class=lnt>143
</span><span class=lnt>144
</span><span class=lnt>145
</span><span class=lnt>146
</span><span class=lnt>147
</span><span class=lnt>148
</span><span class=lnt>149
</span><span class=lnt>150
</span><span class=lnt>151
</span><span class=lnt>152
</span><span class=lnt>153
</span><span class=lnt>154
</span><span class=lnt>155
</span><span class=lnt>156
</span><span class=lnt>157
</span><span class=lnt>158
</span><span class=lnt>159
</span><span class=lnt>160
</span><span class=lnt>161
</span><span class=lnt>162
</span><span class=lnt>163
</span><span class=lnt>164
</span><span class=lnt>165
</span><span class=lnt>166
</span><span class=lnt>167
</span><span class=lnt>168
</span><span class=lnt>169
</span><span class=lnt>170
</span><span class=lnt>171
</span><span class=lnt>172
</span><span class=lnt>173
</span><span class=lnt>174
</span><span class=lnt>175
</span><span class=lnt>176
</span><span class=lnt>177
</span><span class=lnt>178
</span><span class=lnt>179
</span><span class=lnt>180
</span><span class=lnt>181
</span><span class=lnt>182
</span><span class=lnt>183
</span><span class=lnt>184
</span><span class=lnt>185
</span><span class=lnt>186
</span><span class=lnt>187
</span><span class=lnt>188
</span><span class=lnt>189
</span><span class=lnt>190
</span><span class=lnt>191
</span><span class=lnt>192
</span><span class=lnt>193
</span><span class=lnt>194
</span><span class=lnt>195
</span><span class=lnt>196
</span><span class=lnt>197
</span><span class=lnt>198
</span><span class=lnt>199
</span><span class=lnt>200
</span><span class=lnt>201
</span><span class=lnt>202
</span><span class=lnt>203
</span><span class=lnt>204
</span><span class=lnt>205
</span><span class=lnt>206
</span><span class=lnt>207
</span><span class=lnt>208
</span><span class=lnt>209
</span><span class=lnt>210
</span><span class=lnt>211
</span><span class=lnt>212
</span><span class=lnt>213
</span><span class=lnt>214
</span><span class=lnt>215
</span><span class=lnt>216
</span><span class=lnt>217
</span><span class=lnt>218
</span><span class=lnt>219
</span><span class=lnt>220
</span><span class=lnt>221
</span><span class=lnt>222
</span><span class=lnt>223
</span><span class=lnt>224
</span><span class=lnt>225
</span><span class=lnt>226
</span><span class=lnt>227
</span><span class=lnt>228
</span><span class=lnt>229
</span><span class=lnt>230
</span><span class=lnt>231
</span><span class=lnt>232
</span><span class=lnt>233
</span><span class=lnt>234
</span><span class=lnt>235
</span><span class=lnt>236
</span><span class=lnt>237
</span><span class=lnt>238
</span><span class=lnt>239
</span><span class=lnt>240
</span><span class=lnt>241
</span><span class=lnt>242
</span><span class=lnt>243
</span><span class=lnt>244
</span><span class=lnt>245
</span><span class=lnt>246
</span><span class=lnt>247
</span><span class=lnt>248
</span><span class=lnt>249
</span><span class=lnt>250
</span><span class=lnt>251
</span><span class=lnt>252
</span><span class=lnt>253
</span><span class=lnt>254
</span><span class=lnt>255
</span><span class=lnt>256
</span><span class=lnt>257
</span><span class=lnt>258
</span><span class=lnt>259
</span><span class=lnt>260
</span><span class=lnt>261
</span><span class=lnt>262
</span><span class=lnt>263
</span><span class=lnt>264
</span><span class=lnt>265
</span><span class=lnt>266
</span><span class=lnt>267
</span><span class=lnt>268
</span><span class=lnt>269
</span><span class=lnt>270
</span><span class=lnt>271
</span><span class=lnt>272
</span><span class=lnt>273
</span><span class=lnt>274
</span><span class=lnt>275
</span><span class=lnt>276
</span><span class=lnt>277
</span><span class=lnt>278
</span><span class=lnt>279
</span><span class=lnt>280
</span><span class=lnt>281
</span><span class=lnt>282
</span><span class=lnt>283
</span><span class=lnt>284
</span><span class=lnt>285
</span><span class=lnt>286
</span><span class=lnt>287
</span><span class=lnt>288
</span><span class=lnt>289
</span><span class=lnt>290
</span><span class=lnt>291
</span><span class=lnt>292
</span><span class=lnt>293
</span><span class=lnt>294
</span><span class=lnt>295
</span><span class=lnt>296
</span><span class=lnt>297
</span><span class=lnt>298
</span><span class=lnt>299
</span><span class=lnt>300
</span><span class=lnt>301
</span><span class=lnt>302
</span><span class=lnt>303
</span><span class=lnt>304
</span><span class=lnt>305
</span><span class=lnt>306
</span><span class=lnt>307
</span><span class=lnt>308
</span><span class=lnt>309
</span><span class=lnt>310
</span><span class=lnt>311
</span><span class=lnt>312
</span><span class=lnt>313
</span><span class=lnt>314
</span><span class=lnt>315
</span><span class=lnt>316
</span><span class=lnt>317
</span><span class=lnt>318
</span><span class=lnt>319
</span><span class=lnt>320
</span><span class=lnt>321
</span><span class=lnt>322
</span><span class=lnt>323
</span><span class=lnt>324
</span><span class=lnt>325
</span><span class=lnt>326
</span><span class=lnt>327
</span><span class=lnt>328
</span><span class=lnt>329
</span><span class=lnt>330
</span><span class=lnt>331
</span><span class=lnt>332
</span><span class=lnt>333
</span><span class=lnt>334
</span><span class=lnt>335
</span><span class=lnt>336
</span><span class=lnt>337
</span><span class=lnt>338
</span><span class=lnt>339
</span><span class=lnt>340
</span><span class=lnt>341
</span><span class=lnt>342
</span><span class=lnt>343
</span><span class=lnt>344
</span><span class=lnt>345
</span><span class=lnt>346
</span><span class=lnt>347
</span><span class=lnt>348
</span><span class=lnt>349
</span><span class=lnt>350
</span><span class=lnt>351
</span><span class=lnt>352
</span><span class=lnt>353
</span><span class=lnt>354
</span><span class=lnt>355
</span><span class=lnt>356
</span><span class=lnt>357
</span><span class=lnt>358
</span><span class=lnt>359
</span><span class=lnt>360
</span><span class=lnt>361
</span><span class=lnt>362
</span><span class=lnt>363
</span><span class=lnt>364
</span><span class=lnt>365
</span><span class=lnt>366
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># run_system.py</span>
</span></span><span class=line><span class=cl><span class=c1>#!/usr/bin/env python3</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>json</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>chromadb</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>langchain_community.document_loaders</span> <span class=kn>import</span> <span class=n>DirectoryLoader</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>langchain.text_splitter</span> <span class=kn>import</span> <span class=n>RecursiveCharacterTextSplitter</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>langchain_community.vectorstores</span> <span class=kn>import</span> <span class=n>Chroma</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>langchain_ollama</span> <span class=kn>import</span> <span class=n>OllamaEmbeddings</span><span class=p>,</span> <span class=n>OllamaLLM</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>langchain.prompts</span> <span class=kn>import</span> <span class=n>PromptTemplate</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>langchain_core.runnables</span> <span class=kn>import</span> <span class=n>RunnablePassthrough</span><span class=p>,</span> <span class=n>RunnableLambda</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>argparse</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>shutil</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>time</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>traceback</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>NVD_API_KEY</span> <span class=o>=</span> <span class=s2>&#34;redacted&#34;</span>
</span></span><span class=line><span class=cl><span class=n>DATA_DIR</span> <span class=o>=</span> <span class=s2>&#34;./cve_data&#34;</span>
</span></span><span class=line><span class=cl><span class=n>DB_PATH</span> <span class=o>=</span> <span class=s2>&#34;./cve_database&#34;</span>
</span></span><span class=line><span class=cl><span class=n>COLLECTION_NAME</span> <span class=o>=</span> <span class=s2>&#34;cve_collection&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>clear_data_directory</span><span class=p>(</span><span class=n>logger</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>exists</span><span class=p>(</span><span class=n>DATA_DIR</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>logger</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>logger</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Clearing contents of </span><span class=si>{</span><span class=n>DATA_DIR</span><span class=si>}</span><span class=s2>...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>filename</span> <span class=ow>in</span> <span class=n>os</span><span class=o>.</span><span class=n>listdir</span><span class=p>(</span><span class=n>DATA_DIR</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>file_path</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>DATA_DIR</span><span class=p>,</span> <span class=n>filename</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>isfile</span><span class=p>(</span><span class=n>file_path</span><span class=p>)</span> <span class=ow>or</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>islink</span><span class=p>(</span><span class=n>file_path</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                    <span class=n>os</span><span class=o>.</span><span class=n>unlink</span><span class=p>(</span><span class=n>file_path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>elif</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>isdir</span><span class=p>(</span><span class=n>file_path</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                    <span class=n>shutil</span><span class=o>.</span><span class=n>rmtree</span><span class=p>(</span><span class=n>file_path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>logger</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=n>logger</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Failed to delete </span><span class=si>{</span><span class=n>file_path</span><span class=si>}</span><span class=s2>. Reason: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>os</span><span class=o>.</span><span class=n>makedirs</span><span class=p>(</span><span class=n>DATA_DIR</span><span class=p>,</span> <span class=n>exist_ok</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>logger</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>logger</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Created data directory: </span><span class=si>{</span><span class=n>DATA_DIR</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>exists</span><span class=p>(</span><span class=n>DB_PATH</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>logger</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>logger</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Deleting database directory </span><span class=si>{</span><span class=n>DB_PATH</span><span class=si>}</span><span class=s2>...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>shutil</span><span class=o>.</span><span class=n>rmtree</span><span class=p>(</span><span class=n>DB_PATH</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>logger</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>logger</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Successfully deleted </span><span class=si>{</span><span class=n>DB_PATH</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>logger</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>logger</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Failed to delete database directory </span><span class=si>{</span><span class=n>DB_PATH</span><span class=si>}</span><span class=s2>. Reason: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>logger</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>logger</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Database directory </span><span class=si>{</span><span class=n>DB_PATH</span><span class=si>}</span><span class=s2> does not exist, skipping deletion.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>fetch_exploit_db_id</span><span class=p>(</span><span class=n>cve_id</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>search_url</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;[https://www.exploit-db.com/search?cve=](https://www.exploit-db.com/search?cve=)</span><span class=si>{</span><span class=n>cve_id</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>headers</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;Accept&#34;</span><span class=p>:</span> <span class=s2>&#34;application/json, text/javascript, */*; q=0.01&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;X-Requested-With&#34;</span><span class=p>:</span> <span class=s2>&#34;XMLHttpRequest&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;User-Agent&#34;</span><span class=p>:</span> <span class=s2>&#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64) &#34;</span>
</span></span><span class=line><span class=cl>                      <span class=s2>&#34;AppleWebKit/537.36 (KHTML, like Gecko) &#34;</span>
</span></span><span class=line><span class=cl>                      <span class=s2>&#34;Chrome/115.0.0.0 Safari/537.36&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;Referer&#34;</span><span class=p>:</span> <span class=s2>&#34;[https://www.exploit-db.com/](https://www.exploit-db.com/)&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>response</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>search_url</span><span class=p>,</span> <span class=n>headers</span><span class=o>=</span><span class=n>headers</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>response</span><span class=o>.</span><span class=n>raise_for_status</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>data</span> <span class=o>=</span> <span class=n>response</span><span class=o>.</span><span class=n>json</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&#34;recordsTotal&#34;</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>0</span> <span class=ow>and</span> <span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&#34;data&#34;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>exploit_ids</span> <span class=o>=</span> <span class=p>[</span><span class=n>item</span><span class=p>[</span><span class=s2>&#34;id&#34;</span><span class=p>]</span> <span class=k>for</span> <span class=n>item</span> <span class=ow>in</span> <span class=n>data</span><span class=p>[</span><span class=s2>&#34;data&#34;</span><span class=p>]]</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>logger</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>logger</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Found Exploit-DB IDs </span><span class=si>{</span><span class=n>exploit_ids</span><span class=si>}</span><span class=s2> for CVE </span><span class=si>{</span><span class=n>cve_id</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>exploit_ids</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>logger</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>logger</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;No Exploit-DB entries found for CVE </span><span class=si>{</span><span class=n>cve_id</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>logger</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>logger</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Failed to fetch Exploit-DB ID: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>fetch_exploit_db_poc</span><span class=p>(</span><span class=n>exploit_id</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>raw_url</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;[https://www.exploit-db.com/raw/](https://www.exploit-db.com/raw/)</span><span class=si>{</span><span class=n>exploit_id</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>headers</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;User-Agent&#34;</span><span class=p>:</span> <span class=s2>&#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64) &#34;</span>
</span></span><span class=line><span class=cl>                      <span class=s2>&#34;AppleWebKit/537.36 (KHTML, like Gecko) &#34;</span>
</span></span><span class=line><span class=cl>                      <span class=s2>&#34;Chrome/115.0.0.0 Safari/537.36&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>response</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>raw_url</span><span class=p>,</span> <span class=n>headers</span><span class=o>=</span><span class=n>headers</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>response</span><span class=o>.</span><span class=n>raise_for_status</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>logger</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>logger</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Successfully fetched Exploit-DB PoC for ID </span><span class=si>{</span><span class=n>exploit_id</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>response</span><span class=o>.</span><span class=n>text</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>logger</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>logger</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Failed to fetch Exploit-DB PoC: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>fetch_and_save_cve</span><span class=p>(</span><span class=n>cve_id</span><span class=p>,</span> <span class=n>nvd_api_key</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>url</span> <span class=o>=</span> <span class=s2>&#34;[https://services.nvd.nist.gov/rest/json/cves/2.0](https://services.nvd.nist.gov/rest/json/cves/2.0)&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>params</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&#34;cveId&#34;</span><span class=p>:</span> <span class=n>cve_id</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=n>headers</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&#34;apiKey&#34;</span><span class=p>:</span> <span class=n>nvd_api_key</span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>nvd_data</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>    <span class=n>cve_info</span> <span class=o>=</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>response</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>url</span><span class=p>,</span> <span class=n>headers</span><span class=o>=</span><span class=n>headers</span><span class=p>,</span> <span class=n>params</span><span class=o>=</span><span class=n>params</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>response</span><span class=o>.</span><span class=n>raise_for_status</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>nvd_data</span> <span class=o>=</span> <span class=n>response</span><span class=o>.</span><span class=n>json</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>vulns</span> <span class=o>=</span> <span class=n>nvd_data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&#34;vulnerabilities&#34;</span><span class=p>,</span> <span class=p>[])</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>vulns</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>logger</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>logger</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;No NVD data found for </span><span class=si>{</span><span class=n>cve_id</span><span class=si>}</span><span class=s2>. Skipping.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>False</span><span class=p>,</span> <span class=p>[],</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>cve_info</span> <span class=o>=</span> <span class=n>vulns</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&#34;cve&#34;</span><span class=p>,</span> <span class=p>{})</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>logger</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>logger</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Successfully retrieved NVD data for </span><span class=si>{</span><span class=n>cve_id</span><span class=si>}</span><span class=s2>.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>logger</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>logger</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Failed to fetch NVD data: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>False</span><span class=p>,</span> <span class=p>[],</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>cisa_kev_data</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>    <span class=n>mitre_cve_data</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>mitre_url</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;[https://cveawg.mitre.org/api/cve/](https://cveawg.mitre.org/api/cve/)</span><span class=si>{</span><span class=n>cve_id</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>mitre_response</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>mitre_url</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>mitre_response</span><span class=o>.</span><span class=n>raise_for_status</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>mitre_cve_data</span> <span class=o>=</span> <span class=n>mitre_response</span><span class=o>.</span><span class=n>json</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>logger</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>logger</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Successfully retrieved MITRE CVE data for </span><span class=si>{</span><span class=n>cve_id</span><span class=si>}</span><span class=s2>.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>logger</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>logger</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Failed to fetch MITRE CVE data: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>cisa_url</span> <span class=o>=</span> <span class=s2>&#34;[https://www.cisa.gov/sites/default/files/feeds/known_exploited_vulnerabilities.json](https://www.cisa.gov/sites/default/files/feeds/known_exploited_vulnerabilities.json)&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>cisa_response</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>cisa_url</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>cisa_response</span><span class=o>.</span><span class=n>raise_for_status</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>cisa_kev_feed</span> <span class=o>=</span> <span class=n>cisa_response</span><span class=o>.</span><span class=n>json</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>cisa_kev_data</span><span class=p>[</span><span class=s1>&#39;is_kev_exploited&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=nb>any</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>item</span><span class=p>[</span><span class=s1>&#39;cveID&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=n>cve_id</span> <span class=k>for</span> <span class=n>item</span> <span class=ow>in</span> <span class=n>cisa_kev_feed</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;vulnerabilities&#39;</span><span class=p>,</span> <span class=p>[])</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>logger</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>logger</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Successfully retrieved and searched CISA KEV data.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>logger</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>logger</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Failed to fetch CISA KEV data: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>cisa_kev_data</span><span class=p>[</span><span class=s1>&#39;is_kev_exploited&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>exploit_db_ids</span> <span class=o>=</span> <span class=n>fetch_exploit_db_id</span><span class=p>(</span><span class=n>cve_id</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=n>logger</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>exploit_db_pocs</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>eid</span> <span class=ow>in</span> <span class=n>exploit_db_ids</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>poc</span> <span class=o>=</span> <span class=n>fetch_exploit_db_poc</span><span class=p>(</span><span class=n>eid</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=n>logger</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>poc</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>exploit_db_pocs</span><span class=o>.</span><span class=n>append</span><span class=p>((</span><span class=n>eid</span><span class=p>,</span> <span class=n>poc</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=n>poc_filename</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>DATA_DIR</span><span class=p>,</span> <span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>cve_id</span><span class=si>}</span><span class=s2>_exploit_</span><span class=si>{</span><span class=n>eid</span><span class=si>}</span><span class=s2>.md&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>poc_filename</span><span class=p>,</span> <span class=s2>&#34;w&#34;</span><span class=p>,</span> <span class=n>encoding</span><span class=o>=</span><span class=s2>&#34;utf-8&#34;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>f</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;# Exploit DB PoC for </span><span class=si>{</span><span class=n>cve_id</span><span class=si>}</span><span class=s2> - Exploit ID </span><span class=si>{</span><span class=n>eid</span><span class=si>}</span><span class=se>\n\n</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>f</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=s2>&#34;```text</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>f</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>poc</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>f</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>```</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>logger</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>logger</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Saved Exploit-DB PoC to </span><span class=si>{</span><span class=n>poc_filename</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>time</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mf>0.5</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>descriptions</span> <span class=o>=</span> <span class=n>cve_info</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&#34;descriptions&#34;</span><span class=p>,</span> <span class=p>[])</span>
</span></span><span class=line><span class=cl>    <span class=n>description</span> <span class=o>=</span> <span class=n>descriptions</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=s2>&#34;value&#34;</span><span class=p>]</span> <span class=k>if</span> <span class=n>descriptions</span> <span class=k>else</span> <span class=s2>&#34;No description available&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>md_content</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;# CVE Report: </span><span class=si>{</span><span class=n>cve_id</span><span class=si>}</span><span class=se>\n\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>md_content</span> <span class=o>+=</span> <span class=sa>f</span><span class=s2>&#34;## NVD Description</span><span class=se>\n\n</span><span class=si>{</span><span class=n>description</span><span class=si>}</span><span class=se>\n\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>is_kev_exploited</span> <span class=o>=</span> <span class=n>cisa_kev_data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;is_kev_exploited&#39;</span><span class=p>,</span> <span class=kc>False</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>md_content</span> <span class=o>+=</span> <span class=sa>f</span><span class=s2>&#34;**Active Exploitation (CISA KEV):** </span><span class=si>{</span><span class=s1>&#39;Yes&#39;</span> <span class=k>if</span> <span class=n>is_kev_exploited</span> <span class=k>else</span> <span class=s1>&#39;No&#39;</span><span class=si>}</span><span class=se>\n\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>cvss_metrics_v4</span> <span class=o>=</span> <span class=n>cve_info</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&#34;metrics&#34;</span><span class=p>,</span> <span class=p>{})</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&#34;cvssMetricV40&#34;</span><span class=p>,</span> <span class=p>[])</span>
</span></span><span class=line><span class=cl>    <span class=n>cvss_metrics_v3</span> <span class=o>=</span> <span class=n>cve_info</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&#34;metrics&#34;</span><span class=p>,</span> <span class=p>{})</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&#34;cvssMetricV31&#34;</span><span class=p>,</span> <span class=p>[])</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>cvss_metrics_v4</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>cvss</span> <span class=o>=</span> <span class=n>cvss_metrics_v4</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&#34;cvssData&#34;</span><span class=p>,</span> <span class=p>{})</span>
</span></span><span class=line><span class=cl>        <span class=n>md_content</span> <span class=o>+=</span> <span class=sa>f</span><span class=s2>&#34;**CVSS v4 Base Score:** </span><span class=si>{</span><span class=n>cvss</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;baseScore&#39;</span><span class=p>,</span> <span class=s1>&#39;N/A&#39;</span><span class=p>)</span><span class=si>}</span><span class=s2>  </span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>md_content</span> <span class=o>+=</span> <span class=sa>f</span><span class=s2>&#34;**CVSS v4 Base Severity:** </span><span class=si>{</span><span class=n>cvss</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;baseSeverity&#39;</span><span class=p>,</span> <span class=s1>&#39;N/A&#39;</span><span class=p>)</span><span class=si>}</span><span class=se>\n\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>cvss_metrics_v3</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>cvss</span> <span class=o>=</span> <span class=n>cvss_metrics_v3</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&#34;cvssData&#34;</span><span class=p>,</span> <span class=p>{})</span>
</span></span><span class=line><span class=cl>        <span class=n>md_content</span> <span class=o>+=</span> <span class=sa>f</span><span class=s2>&#34;**CVSS v3.1 Base Score:** </span><span class=si>{</span><span class=n>cvss</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;baseScore&#39;</span><span class=p>,</span> <span class=s1>&#39;N/A&#39;</span><span class=p>)</span><span class=si>}</span><span class=s2>  </span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>md_content</span> <span class=o>+=</span> <span class=sa>f</span><span class=s2>&#34;**CVSS v3.1 Base Severity:** </span><span class=si>{</span><span class=n>cvss</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;baseSeverity&#39;</span><span class=p>,</span> <span class=s1>&#39;N/A&#39;</span><span class=p>)</span><span class=si>}</span><span class=se>\n\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>md_content</span> <span class=o>+=</span> <span class=s2>&#34;---</span><span class=se>\n\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>md_content</span> <span class=o>+=</span> <span class=s2>&#34;## Full NVD JSON Response</span><span class=se>\n\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>md_content</span> <span class=o>+=</span> <span class=sa>f</span><span class=s2>&#34;```json</span><span class=se>\n</span><span class=si>{</span><span class=n>json</span><span class=o>.</span><span class=n>dumps</span><span class=p>(</span><span class=n>nvd_data</span><span class=p>,</span> <span class=n>indent</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span><span class=si>}</span><span class=se>\n</span><span class=s2>```</span><span class=se>\n\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>md_content</span> <span class=o>+=</span> <span class=s2>&#34;---</span><span class=se>\n\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>md_content</span> <span class=o>+=</span> <span class=s2>&#34;## MITRE CVE Information</span><span class=se>\n\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>md_content</span> <span class=o>+=</span> <span class=sa>f</span><span class=s2>&#34;```json</span><span class=se>\n</span><span class=si>{</span><span class=n>json</span><span class=o>.</span><span class=n>dumps</span><span class=p>(</span><span class=n>mitre_cve_data</span><span class=p>,</span> <span class=n>indent</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span><span class=si>}</span><span class=se>\n</span><span class=s2>```</span><span class=se>\n\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>os</span><span class=o>.</span><span class=n>makedirs</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>getcwd</span><span class=p>(),</span> <span class=s1>&#39;cve_data&#39;</span><span class=p>),</span> <span class=n>exist_ok</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>md_filename</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>getcwd</span><span class=p>(),</span> <span class=s1>&#39;cve_data&#39;</span><span class=p>,</span> <span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>cve_id</span><span class=si>}</span><span class=s2>.md&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>md_filename</span><span class=p>,</span> <span class=s2>&#34;w&#34;</span><span class=p>,</span> <span class=n>encoding</span><span class=o>=</span><span class=s2>&#34;utf-8&#34;</span><span class=p>)</span> <span class=k>as</span> <span class=n>md_file</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>md_file</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>md_content</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>logger</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>logger</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Enriched Markdown report saved to </span><span class=si>{</span><span class=n>md_filename</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=kc>True</span><span class=p>,</span> <span class=n>exploit_db_ids</span><span class=p>,</span> <span class=n>exploit_db_pocs</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>build_vector_store</span><span class=p>(</span><span class=n>logger</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>logger</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>logger</span><span class=p>(</span><span class=s2>&#34;Initializing persistent Chroma client...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>client</span> <span class=o>=</span> <span class=n>chromadb</span><span class=o>.</span><span class=n>PersistentClient</span><span class=p>(</span><span class=n>path</span><span class=o>=</span><span class=n>DB_PATH</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>embeddings</span> <span class=o>=</span> <span class=n>OllamaEmbeddings</span><span class=p>(</span><span class=n>model</span><span class=o>=</span><span class=s2>&#34;nomic-embed-text&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>loader</span> <span class=o>=</span> <span class=n>DirectoryLoader</span><span class=p>(</span><span class=n>DATA_DIR</span><span class=p>,</span> <span class=n>glob</span><span class=o>=</span><span class=s2>&#34;*.md&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>documents</span> <span class=o>=</span> <span class=n>loader</span><span class=o>.</span><span class=n>load</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>logger</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>logger</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Loaded </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>documents</span><span class=p>)</span><span class=si>}</span><span class=s2> Markdown documents from </span><span class=si>{</span><span class=n>DATA_DIR</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>text_splitter</span> <span class=o>=</span> <span class=n>RecursiveCharacterTextSplitter</span><span class=p>(</span><span class=n>chunk_size</span><span class=o>=</span><span class=mi>1000</span><span class=p>,</span> <span class=n>chunk_overlap</span><span class=o>=</span><span class=mi>200</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>chunks</span> <span class=o>=</span> <span class=n>text_splitter</span><span class=o>.</span><span class=n>split_documents</span><span class=p>(</span><span class=n>documents</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>logger</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>logger</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Split documents into </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>chunks</span><span class=p>)</span><span class=si>}</span><span class=s2> chunks&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>db</span> <span class=o>=</span> <span class=n>Chroma</span><span class=o>.</span><span class=n>from_documents</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>documents</span><span class=o>=</span><span class=n>chunks</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>embedding</span><span class=o>=</span><span class=n>embeddings</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>client</span><span class=o>=</span><span class=n>client</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>collection_name</span><span class=o>=</span><span class=n>COLLECTION_NAME</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>logger</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>logger</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Successfully created a vector store with </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>chunks</span><span class=p>)</span><span class=si>}</span><span class=s2> chunks.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>db</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>logger</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>logger</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Failed to build vector store: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>run_rag_chain</span><span class=p>(</span><span class=n>db</span><span class=p>,</span> <span class=n>cve_id_to_analyze</span><span class=p>,</span> <span class=n>exploit_db_pocs</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>logger</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>logger</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Starting RAG chain analysis for </span><span class=si>{</span><span class=n>cve_id_to_analyze</span><span class=si>}</span><span class=s2>...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>llm</span> <span class=o>=</span> <span class=n>OllamaLLM</span><span class=p>(</span><span class=n>model</span><span class=o>=</span><span class=s2>&#34;mistral:instruct&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>retriever</span> <span class=o>=</span> <span class=n>db</span><span class=o>.</span><span class=n>as_retriever</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>def</span> <span class=nf>escape_braces</span><span class=p>(</span><span class=n>text</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>text</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s2>&#34;{&#34;</span><span class=p>,</span> <span class=s2>&#34;{{&#34;</span><span class=p>)</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s2>&#34;}&#34;</span><span class=p>,</span> <span class=s2>&#34;}}&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>exploit_db_pocs</span> <span class=ow>and</span> <span class=nb>len</span><span class=p>(</span><span class=n>exploit_db_pocs</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>exploit_pocs_text</span> <span class=o>=</span> <span class=s2>&#34;</span><span class=se>\n\n</span><span class=s2>&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                <span class=p>[</span><span class=sa>f</span><span class=s2>&#34;### Exploit ID: </span><span class=si>{</span><span class=n>eid</span><span class=si>}</span><span class=se>\n</span><span class=s2>```text</span><span class=se>\n</span><span class=si>{</span><span class=n>escape_braces</span><span class=p>(</span><span class=n>poc</span><span class=p>)</span><span class=si>}</span><span class=se>\n</span><span class=s2>```&#34;</span> <span class=k>for</span> <span class=n>eid</span><span class=p>,</span> <span class=n>poc</span> <span class=ow>in</span> <span class=n>exploit_db_pocs</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>exploit_pocs_text</span> <span class=o>=</span> <span class=s2>&#34;No public exploit proof-of-concept code found.&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>prompt_template</span> <span class=o>=</span> <span class=n>PromptTemplate</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>template</span><span class=o>=</span><span class=sa>f</span><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>        # </span><span class=si>{</span><span class=n>cve_id_to_analyze</span><span class=si>}</span><span class=s2> Exploitability Analysis Report
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>        ### Context
</span></span></span><span class=line><span class=cl><span class=s2>        Based ONLY on the following context, perform a comprehensive exploitability analysis of the provided CVE. All findings and conclusions MUST be supported by this context. Do not use any external knowledge.
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>        </span><span class=se>{{{{</span><span class=s2>context</span><span class=se>}}}}</span><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>        ### Role
</span></span></span><span class=line><span class=cl><span class=s2>        You are a Expert Level - Senior Penetration Engineer. Your role is to perform a detailed exploitability analysis and impact assessment of the CVE. You are to produce a report that is technical, exhaustive in its detail, comprehensive, and provides clear, actionable guidance on fixes and mitigations.
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>        ### Instructions
</span></span></span><span class=line><span class=cl><span class=s2>        Analyze the provided CVE. Your task is to generate a detailed, multi-section report in Markdown format.
</span></span></span><span class=line><span class=cl><span class=s2>        You MUST follow a step-by-step analytical process before writing the report.
</span></span></span><span class=line><span class=cl><span class=s2>        You MUST provide a clear, concise, and elaborate summary of the CVE and its exploitability status.
</span></span></span><span class=line><span class=cl><span class=s2>        You MUST include a dedicated section for mitigations and fixes.
</span></span></span><span class=line><span class=cl><span class=s2>        You MUST adhere to the formatting and structure specified in the &#39;Expectation&#39; section.
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>        # New Constraint Added Here
</span></span></span><span class=line><span class=cl><span class=s2>        You MUST NOT include any conversational introduction, preamble, or any sentences that refer to the report itself. Start directly with the markdown heading for the CVE.
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>        ### Steps (Chain of Thought)
</span></span></span><span class=line><span class=cl><span class=s2>        BEFORE generating your final report, think step-by-step through the following logical process:
</span></span></span><span class=line><span class=cl><span class=s2>        1. Review the provided context and identify the core vulnerability type and its root cause.
</span></span></span><span class=line><span class=cl><span class=s2>        2. Assess the vulnerability&#39;s potential impact and severity based on the provided CVSS score.
</span></span></span><span class=line><span class=cl><span class=s2>        3. Cross-reference the CVE with CISA&#39;s Known Exploited Vulnerabilities (KEV) catalog. If active exploitation is mentioned, make a specific note of this.
</span></span></span><span class=line><span class=cl><span class=s2>        4. Search for and evaluate evidence of public exploits or proof-of-concept (PoC) code, including the Exploit DB PoCs provided. Consider the reliability and maturity of these exploits.
</span></span></span><span class=line><span class=cl><span class=s2>        5. Synthesize all data points (root cause, CVSS, exploitation evidence, Exploit DB PoCs) to determine the final exploitability verdict: &#34;Critical&#34;, &#34;High&#34;, &#34;Medium&#34;, &#34;Low&#34;, or &#34;Unconfirmed&#34;.
</span></span></span><span class=line><span class=cl><span class=s2>        6. Based on your analysis, propose a clear, prioritized set of mitigations, including temporary workarounds and long-term fixes.
</span></span></span><span class=line><span class=cl><span class=s2>        7. Formulate a final verdict and a high-level summary that captures the essence of your detailed analysis.
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>        ### Expectation
</span></span></span><span class=line><span class=cl><span class=s2>        Your final output MUST be a well-formatted Markdown document with the following exact structure and headings. Each section must be detailed and comprehensive.
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>        ## **Summary**
</span></span></span><span class=line><span class=cl><span class=s2>        A detailed and elaborate summary of the CVE, its technical nature, and a clear explanation of its exploitability status. Include the range of affected version(s) if there exist a number, list, or range.
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>        ## **Verdict**
</span></span></span><span class=line><span class=cl><span class=s2>        The final verdict on the exploitability status: &#34;Critical&#34;, &#34;High&#34;, &#34;Medium&#34;, &#34;Low&#34;, or &#34;Unconfirmed&#34;.
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>        ## **Key Findings**
</span></span></span><span class=line><span class=cl><span class=s2>        A bulleted list highlighting crucial data points from your analysis:
</span></span></span><span class=line><span class=cl><span class=s2>        * **Active Exploitation:** State &#34;Yes (from CISA KEV)&#34; or &#34;No (from CISA KEV)&#34; or &#34;Not Available.&#34;
</span></span></span><span class=line><span class=cl><span class=s2>        * **CVSS Score:** State the full score string (e.g., CVSS 3.1: 8.9) or &#34;Not Available.&#34;
</span></span></span><span class=line><span class=cl><span class=s2>        * **Public Exploits:** State &#34;Confirmed,&#34; &#34;Unconfirmed,&#34; or &#34;Not Available.&#34;
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>        ## Exploit Proof of Concept(s)
</span></span></span><span class=line><span class=cl><span class=s2>        The following Exploit-DB PoCs are associated with this CVE and MUST be included verbatim in the report:
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>        </span><span class=si>{</span><span class=n>exploit_pocs_text</span><span class=si>}</span><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>        ## **Detailed Analysis**
</span></span></span><span class=line><span class=cl><span class=s2>        A multi-paragraph section that explains the technical details of the vulnerability, how it can be exploited, and the factors that contribute to its exploitability verdict. Include your assessment of the Exploit DB PoCs.
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>        ## **Mitigations &amp; Fixes**
</span></span></span><span class=line><span class=cl><span class=s2>        A comprehensive list of recommended actions to mitigate or fix the vulnerability. This must include:
</span></span></span><span class=line><span class=cl><span class=s2>        * Immediate, temporary workarounds.
</span></span></span><span class=line><span class=cl><span class=s2>        * Long-term, permanent fixes (e.g., patching).
</span></span></span><span class=line><span class=cl><span class=s2>        * Any additional security controls (e.g., WAF rules, network segmentation).
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>        ## **Supporting Documents**
</span></span></span><span class=line><span class=cl><span class=s2>        A bulleted list of the documents and sources used for your analysis.
</span></span></span><span class=line><span class=cl><span class=s2>        &#34;&#34;&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>input_variables</span><span class=o>=</span><span class=p>[</span><span class=s2>&#34;context&#34;</span><span class=p>,</span> <span class=s2>&#34;cve_id&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>rag_chain</span> <span class=o>=</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;context&#34;</span><span class=p>:</span> <span class=n>RunnableLambda</span><span class=p>(</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>retriever</span><span class=o>.</span><span class=n>invoke</span><span class=p>(</span><span class=s2>&#34;CVE Report: &#34;</span> <span class=o>+</span> <span class=n>x</span><span class=p>[</span><span class=s1>&#39;cve_id&#39;</span><span class=p>])),</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;cve_id&#34;</span><span class=p>:</span> <span class=n>RunnablePassthrough</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=o>|</span> <span class=n>prompt_template</span>
</span></span><span class=line><span class=cl>            <span class=o>|</span> <span class=n>llm</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>logger</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>logger</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Invoking RAG chain for </span><span class=si>{</span><span class=n>cve_id_to_analyze</span><span class=si>}</span><span class=s2>...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>markdown_report</span> <span class=o>=</span> <span class=n>rag_chain</span><span class=o>.</span><span class=n>invoke</span><span class=p>({</span><span class=s2>&#34;cve_id&#34;</span><span class=p>:</span> <span class=n>cve_id_to_analyze</span><span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>logger</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>logger</span><span class=p>(</span><span class=s2>&#34;RAG chain analysis complete.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>markdown_report</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>logger</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>logger</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;An error occurred during the RAG process: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>logger</span><span class=p>(</span><span class=n>traceback</span><span class=o>.</span><span class=n>format_exc</span><span class=p>())</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s2>&#34;Analysis failed.&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>main</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>log</span><span class=p>(</span><span class=n>msg</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>parser</span> <span class=o>=</span> <span class=n>argparse</span><span class=o>.</span><span class=n>ArgumentParser</span><span class=p>(</span><span class=n>description</span><span class=o>=</span><span class=s2>&#34;Analyze a CVE using RAG.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>parser</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span><span class=s2>&#34;--cve&#34;</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=nb>str</span><span class=p>,</span> <span class=n>required</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>help</span><span class=o>=</span><span class=s2>&#34;The CVE ID to analyze.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>args</span> <span class=o>=</span> <span class=n>parser</span><span class=o>.</span><span class=n>parse_args</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>cve_to_analyze</span> <span class=o>=</span> <span class=n>args</span><span class=o>.</span><span class=n>cve</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>success</span><span class=p>,</span> <span class=n>exploit_ids</span><span class=p>,</span> <span class=n>exploit_db_pocs</span> <span class=o>=</span> <span class=n>fetch_and_save_cve</span><span class=p>(</span><span class=n>cve_to_analyze</span><span class=p>,</span> <span class=n>NVD_API_KEY</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=n>log</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>success</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>db</span> <span class=o>=</span> <span class=n>build_vector_store</span><span class=p>(</span><span class=n>logger</span><span class=o>=</span><span class=n>log</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>db</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>run_rag_chain</span><span class=p>(</span><span class=n>db</span><span class=p>,</span> <span class=n>cve_to_analyze</span><span class=p>,</span> <span class=n>exploit_db_pocs</span><span class=o>=</span><span class=n>exploit_db_pocs</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=n>log</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Stopping script due to data retrieval failure.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>main</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><hr><h3 id=apppy-the-streamlit-frontend><code>app.py</code>: The Streamlit Frontend</h3><p>This script provides the <strong>Orchestration Layer</strong> interface for the user. It uses <strong>Streamlit</strong> to create a simple web application that allows users to input a CVE ID and initiate the full analysis pipeline.</p><ul><li><p><strong>User Interface (UI):</strong> Provides a clean input field for the CVE ID and a &ldquo;Run Analysis&rdquo; button.</p></li><li><p><strong>Workflow Orchestration:</strong> It imports and sequentially calls the core functions from <code>run_system.py</code>: <code>clear_data_directory</code>, <code>fetch_and_save_cve</code>, <code>build_vector_store</code>, and <code>run_rag_chain</code>.</p></li><li><p><strong>Logging and Status:</strong> It uses a real-time status container to log the progress of each step (e.g., fetching data, building DB, running LLM), giving the user visibility into the backend process.</p></li><li><p><strong>Result Presentation:</strong> Upon completion, it renders the final Markdown report generated by the RAG chain and includes a &ldquo;Copy Report&rdquo; button.</p></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span><span class=lnt>80
</span><span class=lnt>81
</span><span class=lnt>82
</span><span class=lnt>83
</span><span class=lnt>84
</span><span class=lnt>85
</span><span class=lnt>86
</span><span class=lnt>87
</span><span class=lnt>88
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># app.py</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>streamlit</span> <span class=k>as</span> <span class=nn>st</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>time</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>json</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>sys</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>re</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>st_copy_to_clipboard</span> <span class=kn>import</span> <span class=n>st_copy_to_clipboard</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>chromadb</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>langchain_ollama</span> <span class=kn>import</span> <span class=n>OllamaEmbeddings</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>langchain_community.vectorstores</span> <span class=kn>import</span> <span class=n>Chroma</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>run_system</span> <span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>fetch_and_save_cve</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>build_vector_store</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>run_rag_chain</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>clear_data_directory</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>NVD_API_KEY</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>DB_PATH</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>COLLECTION_NAME</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>clean_llm_output</span><span class=p>(</span><span class=n>text</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>re</span><span class=o>.</span><span class=n>sub</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;^`{1,}|`{1,}$&#39;</span><span class=p>,</span> <span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=n>text</span><span class=o>.</span><span class=n>strip</span><span class=p>())</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>st</span><span class=o>.</span><span class=n>set_page_config</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>page_title</span><span class=o>=</span><span class=s2>&#34;Local CVE Exploitability Analyzer&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>page_icon</span><span class=o>=</span><span class=s2>&#34;🕵️‍♂️&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>layout</span><span class=o>=</span><span class=s2>&#34;centered&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>st</span><span class=o>.</span><span class=n>title</span><span class=p>(</span><span class=s2>&#34;🕵️‍♂️ CVE Exploitability Analyzer&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>st</span><span class=o>.</span><span class=n>write</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;Enter a CVE ID to fetch its data, build a knowledge base, and analyze its exploitability using a local RAG system.&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>cve_id_input</span> <span class=o>=</span> <span class=n>st</span><span class=o>.</span><span class=n>text_input</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;Enter CVE ID:&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>placeholder</span><span class=o>=</span><span class=s2>&#34;CVE-YYYY-NNNN&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=n>st</span><span class=o>.</span><span class=n>button</span><span class=p>(</span><span class=s2>&#34;Run Analysis&#34;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=n>cve_id_input</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>st</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=s2>&#34;Please enter a CVE ID.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>start_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>log_lines</span> <span class=o>=</span> <span class=p>[]</span>  <span class=c1># fresh log lines for this run</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># Create logs container BEFORE defining log()</span>
</span></span><span class=line><span class=cl>        <span class=n>logs_display</span> <span class=o>=</span> <span class=n>st</span><span class=o>.</span><span class=n>empty</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>def</span> <span class=nf>log</span><span class=p>(</span><span class=n>msg</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>log_lines</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>logs_display</span><span class=o>.</span><span class=n>code</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>log_lines</span><span class=p>),</span> <span class=n>language</span><span class=o>=</span><span class=s2>&#34;text&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>with</span> <span class=n>st</span><span class=o>.</span><span class=n>status</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Analyzing </span><span class=si>{</span><span class=n>cve_id_input</span><span class=si>}</span><span class=s2>...&#34;</span><span class=p>,</span> <span class=n>expanded</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>state</span><span class=o>=</span><span class=s2>&#34;running&#34;</span><span class=p>)</span> <span class=k>as</span> <span class=n>status</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>status</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=n>label</span><span class=o>=</span><span class=sa>f</span><span class=s2>&#34;Clearing old data...&#34;</span><span class=p>,</span> <span class=n>state</span><span class=o>=</span><span class=s2>&#34;running&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>clear_data_directory</span><span class=p>(</span><span class=n>logger</span><span class=o>=</span><span class=n>log</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=n>status</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=n>label</span><span class=o>=</span><span class=sa>f</span><span class=s2>&#34;Fetching data for </span><span class=si>{</span><span class=n>cve_id_input</span><span class=si>}</span><span class=s2>...&#34;</span><span class=p>,</span> <span class=n>state</span><span class=o>=</span><span class=s2>&#34;running&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>fetch_success</span><span class=p>,</span> <span class=n>exploit_ids</span><span class=p>,</span> <span class=n>exploit_db_pocs</span> <span class=o>=</span> <span class=n>fetch_and_save_cve</span><span class=p>(</span><span class=n>cve_id_input</span><span class=p>,</span> <span class=n>NVD_API_KEY</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=n>log</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=ow>not</span> <span class=n>fetch_success</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>status</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=n>label</span><span class=o>=</span><span class=sa>f</span><span class=s2>&#34;Failed to fetch data for </span><span class=si>{</span><span class=n>cve_id_input</span><span class=si>}</span><span class=s2>.&#34;</span><span class=p>,</span> <span class=n>state</span><span class=o>=</span><span class=s2>&#34;error&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>st</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=s2>&#34;Failed to fetch CVE data. Please check the CVE ID.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>st</span><span class=o>.</span><span class=n>stop</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=n>status</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=n>label</span><span class=o>=</span><span class=sa>f</span><span class=s2>&#34;Data fetched! Building fresh vector store...&#34;</span><span class=p>,</span> <span class=n>state</span><span class=o>=</span><span class=s2>&#34;running&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>db</span> <span class=o>=</span> <span class=n>build_vector_store</span><span class=p>(</span><span class=n>logger</span><span class=o>=</span><span class=n>log</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=ow>not</span> <span class=n>db</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>status</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=n>label</span><span class=o>=</span><span class=s2>&#34;Failed to initialize vector store.&#34;</span><span class=p>,</span> <span class=n>state</span><span class=o>=</span><span class=s2>&#34;error&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>st</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=s2>&#34;Vector store could not be initialized.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>st</span><span class=o>.</span><span class=n>stop</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=n>status</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=n>label</span><span class=o>=</span><span class=sa>f</span><span class=s2>&#34;Database ready! Running LLM analysis on </span><span class=si>{</span><span class=n>cve_id_input</span><span class=si>}</span><span class=s2>...&#34;</span><span class=p>,</span> <span class=n>state</span><span class=o>=</span><span class=s2>&#34;running&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>report_output</span> <span class=o>=</span> <span class=n>run_rag_chain</span><span class=p>(</span><span class=n>db</span><span class=p>,</span> <span class=n>cve_id_input</span><span class=p>,</span> <span class=n>exploit_db_pocs</span><span class=o>=</span><span class=n>exploit_db_pocs</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=n>log</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>report_output</span> <span class=ow>and</span> <span class=s2>&#34;Analysis failed&#34;</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>report_output</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>clean_report</span> <span class=o>=</span> <span class=n>clean_llm_output</span><span class=p>(</span><span class=n>report_output</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>elapsed_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start_time</span>
</span></span><span class=line><span class=cl>                <span class=n>status</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=n>label</span><span class=o>=</span><span class=sa>f</span><span class=s2>&#34;Analysis Complete! (Took </span><span class=si>{</span><span class=n>elapsed_time</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2> seconds)&#34;</span><span class=p>,</span> <span class=n>state</span><span class=o>=</span><span class=s2>&#34;complete&#34;</span><span class=p>,</span> <span class=n>expanded</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>st</span><span class=o>.</span><span class=n>success</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Report for </span><span class=si>{</span><span class=n>cve_id_input</span><span class=si>}</span><span class=s2> generated successfully! 🎉&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>st</span><span class=o>.</span><span class=n>markdown</span><span class=p>(</span><span class=n>clean_report</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>st_copy_to_clipboard</span><span class=p>(</span><span class=n>clean_report</span><span class=p>,</span> <span class=s2>&#34;Copy Report&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>status</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=n>label</span><span class=o>=</span><span class=s2>&#34;An error occurred during analysis.&#34;</span><span class=p>,</span> <span class=n>state</span><span class=o>=</span><span class=s2>&#34;error&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>st</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=s2>&#34;An error occurred during the LLM analysis.&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=program-interaction-flow>Program Interaction Flow</h2><p>The two programs work together in a tightly coupled client-server-like model, where <code>app.py</code> acts as the orchestrator and client, and <code>run_system.py</code> provides the underlying analytical services.</p><ol><li><p><strong>User Initiates Analysis:</strong> The user enters a CVE ID in the <code>app.py</code> Streamlit interface and clicks &ldquo;Run Analysis.&rdquo;</p></li><li><p><strong>Orchestration (app.py):</strong> <code>app.py</code> begins the process, managing the status display and logs.</p></li><li><p><strong>Data Cleanup & Retrieval (run_system.py via app.py):</strong> <code>app.py</code> calls <code>clear_data_directory</code> to ensure a clean state, followed by <code>fetch_and_save_cve</code> to gather data from NVD, MITRE, CISA, and Exploit-DB, storing it in the <code>cve_data</code> directory.</p></li><li><p><strong>Knowledge Base Build (run_system.py via app.py):</strong> <code>app.py</code> calls <code>build_vector_store</code>, which reads the new Markdown files, chunks them, embeds them, and stores the vectors in the <code>cve_database</code> (ChromaDB).</p></li><li><p><strong>LLM Analysis (run_system.py via app.py):</strong> <code>app.py</code> calls the core RAG function, <code>run_rag_chain</code>. This function uses the new vector store for context, queries the Ollama LLM (<code>mistral:instruct</code>), and returns the final, structured Markdown report.</p></li><li><p><strong>Report Display (app.py):</strong> <code>app.py</code> receives the Markdown report, cleans it, and renders it directly in the Streamlit application for the user.</p></li></ol><hr><h2 id=results--outputs>Results & Outputs</h2><h3 id=template-terminalstreamlit-log-output>Template Terminal/Streamlit Log Output</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>Clearing contents of ./cve_data...
</span></span><span class=line><span class=cl>Deleting database directory ./cve_database...
</span></span><span class=line><span class=cl>Successfully deleted ./cve_database
</span></span><span class=line><span class=cl>Successfully retrieved NVD data for CVE-YYYY-NNNN.
</span></span><span class=line><span class=cl>Successfully retrieved MITRE CVE data for CVE-YYYY-NNNN.
</span></span><span class=line><span class=cl>Successfully retrieved and searched CISA KEV data.
</span></span><span class=line><span class=cl>Found Exploit-DB IDs [&#39;XXXXX&#39;, &#39;YYYYY&#39;] for CVE CVE-YYYY-NNNN
</span></span><span class=line><span class=cl>Successfully fetched Exploit-DB PoC for ID XXXXX
</span></span><span class=line><span class=cl>Saved Exploit-DB PoC to ./cve_data/CVE-YYYY-NNNN_exploit_XXXXX.md
</span></span><span class=line><span class=cl>Successfully fetched Exploit-DB PoC for ID YYYYY
</span></span><span class=line><span class=cl>Saved Exploit-DB PoC to ./cve_data/CVE-YYYY-NNNN_exploit_YYYYY.md
</span></span><span class=line><span class=cl>Enriched Markdown report saved to /path/to/cve-explpoit-proj/cve_data/CVE-YYYY-NNNN.md
</span></span><span class=line><span class=cl>Initializing persistent Chroma client...
</span></span><span class=line><span class=cl>Loaded 3 Markdown documents from ./cve_data
</span></span><span class=line><span class=cl>Split documents into 12 chunks
</span></span><span class=line><span class=cl>Successfully created a vector store with 12 chunks.
</span></span><span class=line><span class=cl>Starting RAG chain analysis for CVE-YYYY-NNNN...
</span></span><span class=line><span class=cl>Invoking RAG chain for CVE-YYYY-NNNN...
</span></span><span class=line><span class=cl>RAG chain analysis complete.
</span></span></code></pre></td></tr></table></div></div><h3 id=real-terminalstreamlit-log-output>Real Terminal/Streamlit Log Output</h3><p><img src=/p/local-cve-exploitability-analyzer/first.png width=2000 height=1215 srcset="/p/local-cve-exploitability-analyzer/first_hu_13130353c99e4b0d.png 480w, /p/local-cve-exploitability-analyzer/first_hu_f4075b3820cebe92.png 1024w" loading=lazy alt="Data fetched! Building fresh vector store…" class=gallery-image data-flex-grow=164 data-flex-basis=395px></p><p><img src=/p/local-cve-exploitability-analyzer/second.png width=2000 height=1213 srcset="/p/local-cve-exploitability-analyzer/second_hu_8a6d322c98f4f60.png 480w, /p/local-cve-exploitability-analyzer/second_hu_d7c2eb50dfd3eb76.png 1024w" loading=lazy alt="Database ready! Running LLM analysis on CVE…" class=gallery-image data-flex-grow=164 data-flex-basis=395px></p><p><img src=/p/local-cve-exploitability-analyzer/third.png width=2000 height=1216 srcset="/p/local-cve-exploitability-analyzer/third_hu_b841da1bf384369a.png 480w, /p/local-cve-exploitability-analyzer/third_hu_f3f466084ed1b866.png 1024w" loading=lazy alt="Analysis Complete!" class=gallery-image data-flex-grow=164 data-flex-basis=394px></p><p><img src=/p/local-cve-exploitability-analyzer/final.png width=738 height=1460 srcset="/p/local-cve-exploitability-analyzer/final_hu_9a5caf8737fbff85.png 480w, /p/local-cve-exploitability-analyzer/final_hu_b16f63f50c2a7444.png 1024w" loading=lazy alt="Report for CVE generated successfully! 🎉" class=gallery-image data-flex-grow=50 data-flex-basis=121px></p></section><footer class=article-footer><section class=article-tags><a href=/tags/project/>Project</a></section><section class=article-lastmod><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<span>Last updated on Thu Oct 09, 2025</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article class=has-image><a href=/p/approach-to-retrieval-augmented-generation-rag/><div class=article-image><img src=/p/approach-to-retrieval-augmented-generation-rag/balrog.a4559cfa3703d374750bb8aefcf54041_hu_50f41ab47a821f2.jpg width=250 height=150 loading=lazy alt="Featured image of post Approach to Retrieval-Augmented Generation (RAG)" data-hash="md5-pFWc+jcD03R1C7iu/PVAQQ=="></div><div class=article-details><h2 class=article-title>Approach to Retrieval-Augmented Generation (RAG)</h2></div></a></article><article class=has-image><a href=/p/local-ai-setup/><div class=article-image><img src=/p/local-ai-setup/ollama.17043ccc385d9e14cd4dd40474918aea_hu_fe83d579461207b5.png width=250 height=150 loading=lazy alt="Featured image of post Local AI Setup" data-hash="md5-FwQ8zDhdnhTNTdQEdJGK6g=="></div><div class=article-details><h2 class=article-title>Local AI Setup</h2></div></a></article></div></div></aside><footer class=site-footer><section class=copyright>&copy;
2024 -
2025 @crxso</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.31.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>